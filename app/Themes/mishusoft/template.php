<?php
 use Mishusoft\Storage;use Mishusoft\Services\SEOToolKitService;use Mishusoft\System\Log;use Mishusoft\System\Memory;use Mishusoft\Ui;use Mishusoft\Authentication\Session;use Mishusoft\Utility\Inflect;Log::info('mishusoft.php template is running..');Log::info('UI started');Ui::start();Log::info('UI set document title');Ui::setDocumentTitle($this->titleOfCurrentWebPage);Log::info('UI checking template use or not');if($this->templateUse==='no'){Log::info('UI build document for themselves');Ui::setDocumentContentBody(Ui::element(Ui::getDocumentRoot(),'body'));Ui::element(Ui::getDocumentContentBody(),'script',['id'=>'content-loader','text'=>0]);Log::info('UI load current page.');include_once $this->loadTemplateFile();}else{(new SEOToolKitService($this))->start();Ui::elementList(Ui::getDocumentHeadElement(),['link'=>Storage::assignableWebFavicons()]);Ui::elementList(Ui::getDocumentHeadElement(),['meta'=>[['name'=>'mobile-web-app-capable','content'=>'yes',],['name'=>'apple-mobile-web-app-capable','content'=>'yes',],['name'=>'application-name','content'=>DEFAULT_APP_NAME,],['name'=>'apple-mobile-web-app-title','content'=>DEFAULT_APP_NAME,],['name'=>'msapplication-starturl','content'=>Ui\ProgressiveWebApplication::startUrl(),],],'link'=>[['rel'=>'manifest','href'=>Ui\ProgressiveWebApplication::loadManifestFile(),],],]);Ui::element(Ui::getDocumentHeadElement(),'meta',['name'=>'googlebot','content'=>'nosnippet']);Ui::elementList(Ui::getDocumentHeadElement(),['meta'=>[['id'=>'meta-title','name'=>'meta-title','content'=>$this->titleOfCurrentWebPage,],['id'=>'meta-app-name','name'=>'meta-app-name','content'=>Memory::Data()->name,],['id'=>'mishusoft-web-root','name'=>'mishusoft-web-root','content'=>Memory::Data('framework')->host->url,],['id'=>'mishusoft-session-validity','name'=>'mishusoft-session-validity','content'=>Session::get('auth'),],],]);Ui::elementList(Ui::getDocumentHeadElement(),['style'=>[['type'=>'text/css','id'=>'theme.css','text'=>file_get_contents(Storage::assetsFullPath('css/mishusoft-theme.css')),],['type'=>'text/css','id'=>'theme.css','text'=>file_get_contents(Storage::assetsFullPath('css/framework.css')),],],]);Ui::element(Ui::getDocumentHeadElement(),'style',['text'=>file_get_contents(Storage::assetsFullPath('css/loader.css')),]);Ui::setTemplateBody(Ui::element(Ui::getDocumentRoot(),'body',['id'=>Inflect::lower(Ui::makeBodyId($this->request)),'class'=>'ms-app background-image','theme'=>'mishusoft',]));Ui::setDocumentLoader(Ui::getTemplateBody(),'images/loaders/app-loader.gif');Ui::setNoScriptText(Ui::getTemplateBody());Ui::setDocumentContentHeader(Ui::element(Ui::getTemplateBody(),'header'));Ui::setDocumentContentBody(Ui::element(Ui::getTemplateBody(),'main'));Ui::setDocumentContentFooter(Ui::element(Ui::getTemplateBody(),'footer'));if(array_key_exists('top',$this->getWidgets())===true){foreach($this->getWidgets()['top'] as $widget){include_once $widget;}}if(array_key_exists('header',$this->getWidgets())===true){foreach($this->getWidgets()['header'] as $widget){include_once $widget;}}include_once $this->loadTemplateFile();if(array_key_exists('footer',$this->getWidgets())===true){foreach($this->getWidgets()['footer'] as $widget){include_once $widget;}}Ui::elementList(Ui::getTemplateBody(),['script'=>[['type'=>'application/javascript','text'=>0,],['type'=>'module','rel'=>'prefetch','id'=>'readystate.js','src'=>Storage::toDataUri('assets','js/readystate.js','remote'),],['type'=>'module','rel'=>'prefetch','id'=>'framework.js','src'=>Storage::toDataUri('assets','js/framework.js','remote'),],],]);}Ui::display();