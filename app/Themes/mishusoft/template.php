<?php
 use Mishusoft\Storage;use Mishusoft\Services\SEOToolKitService;use Mishusoft\System\Logger;use Mishusoft\System\Memory;use Mishusoft\Ui;use Mishusoft\Drivers\Session;use Mishusoft\Utility\Inflect;Logger::write('mishusoft.php template is running..');Logger::write('UI started');Ui::start();Logger::write('UI set document title');Ui::setDocumentTitle($this->titleOfCurrentWebPage);Logger::write('UI checking template use or not');if($this->templateUse==='no'){Logger::write('UI build document for themselves');Ui::setDocumentContentBody(Ui::element(Ui::getDocumentRoot(),'body'));Ui::element(Ui::getDocumentContentBody(),'script',['id'=>'content-loader','text'=>0]);Logger::write('UI load current page.');include_once $this->loadTemplateFile();}else{(new SEOToolKitService($this))->start();Ui::elementList(Ui::getDocumentHeadElement(),['link'=>Storage::assignableWebFavicons()]);Ui::elementList(Ui::getDocumentHeadElement(),['meta'=>[['name'=>'robots','content'=>'index, follow',],['name'=>'robots','content'=>'max-image-preview:standard',],['name'=>'robots','content'=>'max-video-preview:-1',],],]);Ui::element(Ui::getDocumentHeadElement(),'meta',['name'=>'googlebot','content'=>'nosnippet']);Ui::elementList(Ui::getDocumentHeadElement(),['meta'=>[['id'=>'meta-title','name'=>'meta-title','content'=>$this->titleOfCurrentWebPage,],['id'=>'meta-app-name','name'=>'meta-app-name','content'=>Memory::Data()->name,],['id'=>'mishusoft-web-root','name'=>'mishusoft-web-root','content'=>Memory::Data('framework')->host->url,],['id'=>'mishusoft-session-validity','name'=>'mishusoft-session-validity','content'=>Session::get('auth'),],],]);Ui::elementList(Ui::getDocumentHeadElement(),['link'=>[['rel'=>'stylesheet','type'=>'text/css','href'=>Storage::assetsFullPath('css/font-face.css','remote'),],['rel'=>'stylesheet','type'=>'text/css','href'=>Storage::assetsFullPath('css/mishusoft-theme.css','remote'),],['rel'=>'stylesheet','type'=>'text/css','href'=>Storage::assetsFullPath('css/app-ui-v4.css','remote'),],],]);Ui::element(Ui::getDocumentHeadElement(),'style',['text'=>file_get_contents(Storage::assetsFullPath('css/loader.css')),]);$templateBodyElement=Ui::element(Ui::getDocumentRoot(),'body',['id'=>Inflect::lower($this->request['controller']),'class'=>'ms-app background-image',]);Ui::setTemplateBody($templateBodyElement);Ui::element(Ui::element(Ui::getTemplateBody(),'div',['id'=>'app-loader','class'=>'app-loader',]),'img',['alt'=>'Loading...','class'=>'app-loader-image','src'=>Storage::toDataUri('media','images/loaders/app-loader.gif'),]);Ui::setNoScriptText(Ui::getTemplateBody());Ui::setDocumentContentHeader(Ui::element(Ui::getTemplateBody(),'header'));Ui::setDocumentContentBody(Ui::element(Ui::getTemplateBody(),'article'));Ui::setDocumentContentFooter(Ui::element(Ui::getTemplateBody(),'footer'));if(array_key_exists('top',$this->getWidgets())===true){foreach($this->getWidgets()['top']as $widget){include_once $widget;}}if(array_key_exists('header',$this->getWidgets())===true){foreach($this->getWidgets()['header']as $widget){include_once $widget;}}include_once $this->loadTemplateFile();if(array_key_exists('footer',$this->getWidgets())===true){foreach($this->getWidgets()['footer']as $widget){include_once $widget;}}Ui::elementList(Ui::getTemplateBody(),['script'=>[['type'=>'application/javascript','text'=>0,],['type'=>'application/javascript','rel'=>'prefetch','src'=>Storage::assetsFullPath('js/readystate.js','remote'),],['type'=>'application/javascript','rel'=>'prefetch','src'=>Storage::assetsFullPath('js/app-js.js','remote'),],],]);}Ui::display();